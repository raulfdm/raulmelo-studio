---
import { PortableText } from 'astro-portabletext';
import { mergeComponents } from 'astro-portabletext/utils';

import Divider from './Divider.astro';
import Image from './Image.astro';
import Gif from './Gif.astro';
import Strikethrough from './Strikethrough.astro';
import ImageSlider from './ImageSlider.astro';
import Highlight from './Highlight.astro';
import BigQuote from './BigQuote.astro';
import CodeBlock from './CodeBlock.astro';
import CodePen from './CodePen.astro';
import Tweet from './Tweet.astro';
import InternalLink from './InternalLink.astro';

type PortableTextProps = Parameters<typeof PortableText>[0];

export interface Props {
  value: PortableTextProps['value'];
  components?: PortableTextProps['components'];
}

const {
  value,
  components = {
    type: {
      divider: Divider,
      image: Image,
      detailedImage: Image,
      gif: Gif,
      imageSlider: ImageSlider,
      code: CodeBlock,
      codePen: CodePen,
      tweet: Tweet,
    },
    mark: {
      strikethrough: Strikethrough,
      highlight: Highlight,
      internalLink: InternalLink,
    },
    block: {
      bigQuote: BigQuote,
    },
  },
  ...attrs
} = Astro.props;

console.log(attrs);
const portableTextProps = {
  value: value,
  components: mergeComponents({}, components),
};
---

<PortableText {...portableTextProps} {...attrs} />
